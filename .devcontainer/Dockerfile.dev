FROM mcr.microsoft.com/devcontainers/python:1-3.12-bullseye

# Avoid prompts during package installation
ARG DEBIAN_FRONTEND=noninteractive

# Install additional packages
RUN apt-get update && apt-get install -y --no-install-recommends \
    libpq-dev \
    curl \
    wget \
    procps \
    && rm -rf /var/lib/apt/lists/*

# Install Supabase CLI directly from GitHub releases
RUN wget -O supabase.deb https://github.com/supabase/cli/releases/download/v1.145.4/supabase_1.145.4_linux_amd64.deb \
    && dpkg -i supabase.deb \
    && rm supabase.deb

# Install UV for package management
RUN curl -fsSL https://astral.sh/uv/install.sh | bash \
    && mv ~/.cargo/bin/uv /usr/local/bin/ \
    && chmod +x /usr/local/bin/uv

# Make sure the container stays running
CMD ["sleep", "infinity"]